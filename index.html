<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Batre3Lit</title>
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="manifest" href="site.webmanifest">
  <meta name="theme-color" content="#3498db">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to right, #ece9e6, #ffffff);
      padding: 20px; /* Kurangi padding agar lebih responsif */
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .container {
      background-color: #fff;
      padding: 30px 40px;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
      max-width: 450px; /* Tambah sedikit max-width */
      width: 100%;
    }

    h2 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 20px;
    }

    label {
      font-size: 16px;
      color: #34495e;
      margin-top: 10px; /* Tambah margin atas untuk label */
      display: block; /* Pastikan label berada di baris sendiri */
    }

    input {
      width: 100%;
      padding: 10px 15px;
      font-size: 16px;
      margin-top: 8px;
      margin-bottom: 20px;
      border: 1px solid #ccc;
      border-radius: 6px;
      transition: border-color 0.3s;
    }

    input:focus {
      border-color: #3498db;
      outline: none;
    }

    button {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin-top: 10px; /* Tambah margin atas untuk tombol */
    }

    button:hover {
      background-color: #2980b9;
    }

    .result {
      margin-top: 25px;
      background-color: #ecf0f1;
      padding: 15px;
      border-radius: 6px;
      font-size: 16px;
      color: #2c3e50;
      box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.05);
    }
    .info-item {
        margin-bottom: 10px;
    }
    .info-item strong {
        color: #34495e;
    }
  </style>
</head>

<body>

  <div class="container">
    <h2 class="text-center mb-3">Batre3Lit</h2>
    <div class="row align-items-center mb-4">
      <div class="col-6">
        <h4 id="indikator" class="mb-0 fw-bold"></h4>
        <div class="fs-1 m-none">
          <i id="battery-icon" class="bi fs-1"></i>
        </div>
      </div>
      <div class="col-6 text-end">
        <h4>Stareer</h4>
        <p class="mb-0">3 Lit</p>
      </div>
    </div>

    <label for="battery">Sisa Baterai Saat Ini (%):</label>
    <input type="number" id="battery" min="0" max="99" placeholder="Contoh: 40">

    <button onclick="hitungSemua()">Hitung Estimasi</button>

    <div class="result" id="hasil">
        <div class="info-item">
            <strong>Jarak Tempuh Tersisa:</strong> <span id="jarakTempuh">-</span> km
        </div>
        <div class="info-item">
            <strong>Waktu Penuh (100%):</strong> <span id="waktuPenuh">-</span>
        </div>
        <div class="info-item">
            <strong>Penuh Pada Pukul:</strong> <span id="jamPenuh">-</span>
        </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>
  <script>
    // Ambil data terakhir dari localStorage saat halaman dibuka
    window.onload = () => {
      const lastInput = localStorage.getItem('lastBatteryInput');
      if (lastInput !== null) {
        document.getElementById('battery').value = lastInput;
        updateBatteryIndicator(lastInput);
        updateBatteryDisplay(parseFloat(lastInput));
        hitungSemua(); // Langsung hitung saat halaman dimuat jika ada input sebelumnya
      }
    };
    function updateBatteryDisplay(percentage) {
      const indicator = document.getElementById('indikator');
        const batteryIcon = document.getElementById('battery-icon'); // Ambil elemen ikon baterai

        indicator.innerHTML = percentage + '%';
        batteryIcon.classList.remove('bi-battery-full', 'bi-battery-half', 'bi-battery-low', 'text-danger', 'text-warning', 'text-success');

        // Tentukan ikon dan warna berdasarkan persentase
        if (percentage >= 75) {
            batteryIcon.classList.add('bi-battery-full', 'text-success');
        } else if (percentage >= 35) {
            batteryIcon.classList.add('bi-battery-half', 'text-warning');
        } else {
            batteryIcon.classList.add('bi-battery-low', 'text-danger');
        }
    }
    function updateBatteryIndicator(percentage) {
        const indicator = document.getElementById('indikator');
        const batteryIcon = document.querySelector('.bi-battery-full'); // Get the battery icon element

        indicator.innerHTML = percentage + '%';
        
        // Update battery icon color based on percentage
        batteryIcon.classList.remove('text-success', 'text-warning', 'text-danger');
        if (percentage >= 60) {
            batteryIcon.classList.add('text-success');
        } else if (percentage >= 20) {
            batteryIcon.classList.add('text-warning');
        } else {
            batteryIcon.classList.add('text-danger');
        }
    }


    function hitungSemua() {
      const inputEl = document.getElementById('battery');
      const sisa = parseFloat(inputEl.value);

      const jarakTempuhEl = document.getElementById('jarakTempuh');
      const waktuPenuhEl = document.getElementById('waktuPenuh');
      const jamPenuhEl = document.getElementById('jamPenuh');

      if (isNaN(sisa) || sisa < 0 || sisa > 100) { // Ubah max menjadi 100 untuk validasi input
        jarakTempuhEl.innerHTML = "⚠️ Masukkan angka antara 0 hingga 100.";
        waktuPenuhEl.innerHTML = "";
        jamPenuhEl.innerHTML = "";
        document.getElementById('battery-icon').classList.remove('bi-battery-full', 'bi-battery-half', 'bi-battery-low', 'text-danger', 'text-warning', 'text-success');
        return;
      }
      updateBatteryDisplay(sisa);
      updateBatteryIndicator(sisa); // Update indicator with current input
      localStorage.setItem('lastBatteryInput', sisa); // Simpan input ke localStorage

      // --- Perhitungan Jarak Tempuh ---
      // Asumsi: 100% baterai bisa menempuh 48 km (48 Wh * 24 jam / rata-rata konsumsi daya per km)
      const jarakTotal = 60; // km
      const jarakTersisa = (sisa / 100) * jarakTotal;
      jarakTempuhEl.innerHTML = jarakTersisa.toFixed(1); // Tampilkan 1 angka di belakang koma

      // --- Perhitungan Waktu Charge ---
      const kapasitasWh = 48 * 24; // 1152 Wh
      const dayaCharger = 48 * 3; // 144 Watt
      const efisiensi = 1.15; // Faktor efisiensi (misal 15% hilang)

      const persenIsiButuh = 100 - sisa;
      const energiButuh = (persenIsiButuh / 100) * kapasitasWh;
      const waktuJam = (energiButuh / dayaCharger) * efisiensi;

      const jam = Math.floor(waktuJam);
      const menit = Math.round((waktuJam - jam) * 60);

      waktuPenuhEl.innerHTML = `${jam} jam ${menit} menit`;

      // --- Estimasi Penuh Jam Berapa ---
      const sekarang = new Date();
      const selesai = new Date(sekarang.getTime() + waktuJam * 60 * 60 * 1000);

      const jamSelesai = selesai.getHours().toString().padStart(2, '0');
      const menitSelesai = selesai.getMinutes().toString().padStart(2, '0');

      jamPenuhEl.innerHTML = `${jamSelesai}:${menitSelesai}`;
    }

    // PWA: Daftarkan Service Worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(reg => console.log('Service Worker terdaftar:', reg.scope))
        .catch(err => console.log('Service Worker gagal:', err));
    }
  </script>

</body>

</html>